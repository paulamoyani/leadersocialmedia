<html>
	<head>
		<title> World Leaders' Social Media Presence in 2018 </title>
		<meta charset="utf-8">
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
		<script src="https://d3js.org/topojson.v2.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.13.0/d3-legend.js"></script>
		<script src="js/functions.js" type="text/javascript"></script>
        <link href="https://fonts.googleapis.com/css?family=Rajdhani|Rubik+Mono+One" rel="stylesheet">
		<style>
            h1 {font-family: 'Rubik Mono One', sans-serif;
                font-size: 24px;
                font-style: normal;
                font-variant: normal;
                font-weight: 200;
                line-height: 26px;
                display: flex;
                justify-content: center;
                position: fixed;
                color: #C1C1C1;

            }
            h2 {font-family: 'Rajdhani', sans-serif;
                font-size: 14px;
                font-style: normal;
                font-variant: normal;
                font-weight: 80;
                line-height: 18px;
                text-align: right;
                padding-top: 15px;
                padding-right: 15px;
                color: #C1C1C1;
            }
            h3 {font-family: 'Rajdhani', sans-serif;
                font-size: 14px;
                font-style: normal;
                font-variant: normal;
                font-weight: 80;
                line-height: 18px;
                text-align: right;
                padding-right: 15px;
                color: #C1C1C1;
            }
            h4 {font-family: 'Rajdhani', sans-serif;
            	font-size: 14px;
            	font-style: normal;
            	font-variant: normal;
            	font-weight: 80;
            	line-height: 18px;
            	text-align: left;
            	padding-left: 35px;
            	color: #8C8C8B;
            }
			body {font-family: 'Rajdhani', sans-serif;
                text-anchor: 'middle';
                dominant-baseline: 'central';
                background: #2B2727;
            }
            .legendSize circle {
                fill: #CE7602;
                opacity: 0.2;
            }
            .legendSize text {
                font-size: 11px;
                fill: #8C8C8B;
            }
            .textstyle1 {
                font-family: 'Rajdhani', sans-serif;
                font-size: 11px;
                font-style: normal;
                fill: #8C8C8B;
            }
            .textstyle2 {
                font-family: 'Rajdhani', sans-serif;
                font-size: 11px;
                font-style: normal;
                fill: #C1C1C1;
            }
            .textstyle3 {
                font-family: 'Rajdhani', sans-serif;
                font-size: 11px;
                font-style: italic;
                fill: #8C8C8B;
            }
            p#footnotes {
                font-family: 'Rajdhani', sans-serif;
                font-size: 12px;
                font-style: normal;
                color: #8C8C8B;
            }
            a {
                text-decoration: none;
                color: #C1C1C1;
            }
		</style>
	</head>

	<body>
		<h1>World Leaders and their Social Media Presence</h1>
        <h2>PROJECT USES DATASET AND NUMBERS FROM 2018</h2>
				<h3>Paula Moya</h3>
        <!-- <h3>Danyal Motiwalla (djm453)
        <br>Paula Moya Nieto (pm445)
        <br>& Rachel Yunyann Liu (rl544)</h3> -->


		<p id=“project1”>

			<!--    				Map for world leaders with social media followers

									Same format as David Mimno's class on maps and projections (Friday, February 16, 2018)

			-->
			<svg id="mapView" style="display: block; margin-left: 0 auto; margin-right: 0 auto" viewBox="-50 0 1100 480" preserveAspectRatio="xMidYMid meet">
			</svg>
			<script type="text/javascript">
				var svg = d3.select(mapView);

                svg.append("text")
						.attr("x", -20)
					    .attr("y", 0)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "16px")
                        .style("font-style", "italic")
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
                        .style("fill", "#C1C1C1")
					    .text("BY TOTAL NO. OF FOLLOWERS");
                svg.append("text")
                        .attr("class", "textstyle1")
						.attr("x", -20)
					    .attr("y", 25)
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("The countries or states named represent the world leaders with the top 10 highest numbers of followers, combining Facebook, Twitter and Instagram.");

        var width = 1010;
				var height = 480;

				var projection = d3.geoEquirectangular().scale(75);
				var pathGenerator = d3.geoPath().projection(projection);

				var rawData;
				var countries;
				var socialMediaData;

				d3.json("data/Merged_Data_Feb21.json", function (error, data) {
					socialMediaData = data;
					var leadersWithFollowers = [];

					socialMediaData.forEach(function (d) {
						if (d.totalFollowers != 0) {
							capitalCityCoord = [d.capitalLongitude, d.capitalLatitude, d.country];
							leadersWithFollowers.push(capitalCityCoord);
						}
					});

					var longitudeExtent0 = d3.extent(socialMediaData, function (d) {
						return d.capitalLongitude;
					});

					var longitudeScale0 = d3.scaleLinear()
					    .domain(longitudeExtent0)
					    .range([0, 1000]);

					//To create larger circles for top 10 leaders
					var followersScale = d3.scaleSqrt()
				    	.domain([0, 98247052])
				    	.range([15, 50]);

					var specialCapitals = [];
					var specialCountries = [];
				    socialMediaData.forEach(function (d) {
						if (d.totalFollowers >= 10021649) {
							specialCapitalCityCoord = [d.capitalLongitude, d.capitalLatitude, d.totalFollowers];
							specialCapitals.push(specialCapitalCityCoord);
							specialCountries.push(d.country);
						}
					});

				  	d3.json("data/world-50m.json", function (error, data) {
					  	rawData = data;
					  	countries = topojson.feature(rawData, rawData.objects.countries);
					  	showMap();
				  	});

					function showMap() {
				  		projection.fitExtent([[-31,70], [1020, 560]], countries);
				  		pathGenerator = d3.geoPath().projection(projection);

				  		var paths = svg.selectAll("path.country")
				  			.data(countries.features)
				    	paths = paths.enter().append("path")
				    	    .attr("class", "country")
							.attr("stroke", "#383434")
                            .attr("stroke-width", "0")
							.attr( "fill", "#4C4848")
				    		.merge(paths);

				    	paths.attr("d", function(country) {
				     		return pathGenerator(country);
				    	})

				    	var circles = svg.selectAll("circle").data(leadersWithFollowers);

				    	circles = circles.enter().append("circle")
				    		.style("fill", "#DD8A05")
				    		.style("opacity", 0.5)
				    		.merge(circles);

				    	circles.attr("cx", function(d) {
				      		return projection(d)[0];
				   		});

				    	circles.attr("cy", function(d) {
				      		return projection(d)[1];
				      	});

				      	circles.attr("r", function(d) {
				    		return 3;
				   		});

				   		var g = svg.selectAll(null)
					        .data(leadersWithFollowers)
					        .enter()
					        .append("g");

				    //circles for top 10 leaders
				   		var specialCircles = svg.selectAll("circle").data(specialCapitals);

				    	specialCircles = specialCircles.enter().append("circle")
				    		.merge(specialCircles);

				    	specialCircles
				    	.attr("cx", function(d) {
				          return projection(d)[0]; })
				    	.attr("cy", function(d) {
				      		return projection(d)[1]; })
						.attr("r", function(d) {
				    		return followersScale((d)[2]); });

						g.append("text")
						.text(function (d,i) {
							for(t=0;t<specialCapitals.length;t++) {
								if(d[2].includes(specialCountries[t])){return specialCountries[t];}
							}
						})
						.attr("y", function(d) {return (projection(d)[1]);})
						.attr("x", function(d) {return projection(d)[0];})
                        .style("font-family", "Rajdhani")
				        .style("font-size", "11px")
                        .style("font-variant", "small-caps")
				        .style("alignment-baseline", "middle")
                        .style("text-anchor", "middle")
                        .style("fill", "#C1C1C1")
						.attr("id", "mapText");

				   	//lines for top 10 leaders
				   		var specialLines = svg.selectAll("line").data(specialCapitals);

				   		specialLines = specialLines.enter().append("line")
				    		.style("opacity", 0.3)
				    		.style("stroke-dasharray","5,5")
				    		.merge(specialLines);

				    	specialLines
				   		.attr("x1", function(d) {
				          return projection(d)[0]})
						.attr("y1", function(d) {
				          return projection(d)[1]})
						.attr("x2", function(d) {
				          return projection(d)[0]})
						.attr("y2",height)
						.style("stroke", "#C1C1C1");

                    //legend
                        svg.append("text")
						.attr("class", "textstyle1")
                        .attr("x", -20)
					    .attr("y", 250)
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("NO. OF FOLLOWERS");

                        svg.append("circle")
                        .attr("id", "legend")
                        .attr("cx", 20)
                        .attr("cy", 283)
                        .attr("r", 3)
				        .style("fill", "#DD8A05")
				        .style("opacity", 0.2)

                        svg.append("text")
                        .attr("class", "textstyle1")
						.attr("x", 63)
					    .attr("y", 283)
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
					    .text("< 10 mil");

                        svg.append("g")
                        .attr("font-family", "Rajdhani")
				        .attr("font-size", 11)
                        .attr("class", "legendSize")
                        .attr("transform", "translate(20, 280)");

                        var legendSize = d3.legendSize()
                        .scale(followersScale)
                        .cells([10000000, 50000000])
                        .shape("circle")
                        .shapePadding(0)
                        .labels(["10 mil", "50 mil"])
                        .labelOffset(10)
                        .orient("vertical");

                        svg.select(".legendSize")
                        .call(legendSize);
					};
				});
			</script>


			<!--    				Population (Log) vs. Longitude Graph

			-->

			<svg id="graph1" style="display: block; margin-left: 0 auto; margin-right: 0 auto" viewBox="-50 0 1100 454" preserveAspectRatio="xMidYMid meet">
			</svg>
			<script type="text/javascript">
				var svg1 = d3.select("#graph1");

                svg1.append("text")
                        .attr("class", "graphTitle")
						.attr("x", -20)
					    .attr("y", 40)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "16px")
                        .style("font-style", "italic")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
                        .style("fill", "#C1C1C1")
					    .text("BY LOG POPULATION SIZE & APPROVAL RATINGS");

				var socialMediaData0;

				d3.json("data/Merged_Data_Feb21.json", function (error, data) {
					socialMediaData0 = data;

					var popExtent = d3.extent(socialMediaData0, function (d) {
						return d.lgPop;
					});

					var popScale = d3.scaleLinear()
					.domain([2.5, 10])
					.range([360, 40]);

					var longitudeExtent = d3.extent(socialMediaData0, function (d) {
						return d.capitalLongitude;
					});
					var longitudeScale = d3.scaleLinear()
					    .domain(longitudeExtent)
					    .range([0, 1000]);

					var longitudeAxis = d3.axisBottom(longitudeScale);
					var longitudeTicks = svg1.append("g")
					.attr("transform", "translate(0, 410)")
					.call(longitudeAxis);

                    // set style of longitude axis
                    longitudeTicks.selectAll("text")
                        .style("font-family", "Rajdhani")
                        .attr("fill", "#4C4848");
                    longitudeTicks.selectAll("path")
                        .attr("stroke", "#4C4848");
                    longitudeTicks.selectAll("line")
                        .attr("stroke", "none");

                    var popAxis = d3.axisLeft(popScale);
					var popTicks = svg1.append("g")
					.attr("transform", "translate(40, 50)")
					.call(popAxis);

                    // set style of pop axis
                    popTicks.selectAll("text")
                        .style("font-family", "Rajdhani")
                        .attr("fill", "#8C8C8B");
                    popTicks.selectAll("path")
                        .attr("stroke", "#8C8C8B");
                    popTicks.selectAll("line")
                        .attr("stroke", "none");

					var followersScale = d3.scaleSqrt()
					.domain([0, 98247052])
					.range([15, 50]);

					var approvalExtent = d3.extent(socialMediaData0, function (d) {
						return d.approvalRatings;
					});

					var approvalScale = d3.scaleLinear()
					.domain(approvalExtent)
					.range([0,1]);

					svg1.append("text")
						.attr("x", 500)
					    .attr("y", 445)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "middle")
                        .style("fill", "#4C4848")
					    .text("Longitude");

					svg1.append("text")
					    .attr("x", -20)
					    .attr("y", 65)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
                        .style("fill", "#8C8C8B")
					    .text("Population (lg)");

					socialMediaData0.forEach(function (d) {
					    if (d.totalFollowers != 0) {
					        if (d.totalFollowers >= 10021649) {
                                if (d.approvalRatings != null) {
                                    svg1.append("circle")
                                    .attr("cx", longitudeScale(d.capitalLongitude))
                                    .attr("cy", popScale(d.lgPop))
                                    .attr("r", followersScale(d.totalFollowers))
                                    .attr("transform", "translate(0, 50)")
                                    .style("fill", "#E24D30")
                                    .style("opacity", approvalScale(d.approvalRatings));
                                }
                                else {
                                    svg1.append("circle")
                                    .attr("cx", longitudeScale(d.capitalLongitude))
                                    .attr("cy", popScale(d.lgPop))
                                    .attr("r", followersScale(d.totalFollowers))
                                    .attr("transform", "translate(0, 50)")
                                    .style("fill", "none")
                                    .style("stroke", "#4C4848")
                                    .style("stroke-width", "2");
                                };
					            svg1.append("line")
					            .attr("x1",longitudeScale(d.capitalLongitude))
					            .attr("x2",longitudeScale(d.capitalLongitude))
					            .attr("y1",0)
					            .attr("y2",height)
					            .style("opacity", 0.3)
					            .style("stroke-dasharray","5,5")
					            .style("stroke", "#C1C1C1");
					        }
					        else {
					            svg1.append("circle")
					            .attr("cx", longitudeScale(d.capitalLongitude))
					            .attr("cy", popScale(d.lgPop))
                                .attr("transform", "translate(0, 50)")
					            .attr("r", 3)
					            .style("fill", "#E24D30")
					            .style("opacity", approvalScale(d.approvalRatings));
					        };
					    };
					});

                    // to layer text above circles.
                    socialMediaData0.forEach(function (d) {
					        if (d.totalFollowers >= 10021649) {
					            svg1.append("circle")
					            .attr("cx", longitudeScale(d.capitalLongitude))
					            .attr("cy", popScale(d.lgPop))
                                .attr("transform", "translate(0, 50)")
					            .attr("r", 1)
					            .style("fill", "#C1C1C1");
                                if (d.worldLeader != "Mauricio Macri") {
                                    svg1.append("text")
                                    .attr("x", longitudeScale(d.capitalLongitude)+5)
                                    .attr("y", popScale(d.lgPop)-0.8)
                                    .attr("transform", "translate(0, 50)")
                                    .style("font-family", "Rajdhani")
                                    .style("font-size", "10px")
                                    .style("alignment-baseline", "middle")
                                    .style("fill", "#C1C1C1")
                                    .text(d.worldLeader);
                                }
                                else {
                                    svg1.append("text")
                                    .attr("x", longitudeScale(d.capitalLongitude)+5)
                                    .attr("y", popScale(d.lgPop)-2)
                                    .attr("transform", "translate(0, 50)")
                                    .style("font-family", "Rajdhani")
                                    .style("font-size", "10px")
                                    .style("alignment-baseline", "baseline")
                                    .style("fill", "#C1C1C1")
                                    .text(d.worldLeader);
                                };
                            };
                    });

                    // approval ratings legend, adapted from: http://bl.ocks.org/darrenjaworski/5397362
                    svg1.append("text")
                        .attr("class", "textstyle1")
					    .attr("x", 69)
					    .attr("y", 243)
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
					    .text("APPROVAL RATINGS");

                    var approvalLegend = svg1.append("defs")
                        .append("svg:linearGradient")
                        .attr("id", "gradient")
                        .attr("x1", "100%")
                        .attr("y1", "0%")
                        .attr("x2", "100%")
                        .attr("y2", "100%");

                    approvalLegend.append("stop")
                        .attr("offset", "0%")
                        .attr("stop-color", "#E24D30")
                        .attr("stop-opacity", 0);

                    approvalLegend.append("stop")
                        .attr("offset", "100%")
                        .attr("stop-color", "#E24D30")
                        .attr("stop-opacity", 1);

                    svg1.append("rect")
                        .attr("width", 15)
                        .attr("height", 80)
                        .style("fill", "url(#gradient)")
                        .attr("transform", "translate(75,257)");

                    svg1.append("text")
                        .attr("class", "textstyle1")
                        .attr("x", 95)
					    .attr("y", 297)
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
					    .text("50%");

                    svg1.append("text")
                        .attr("class", "textstyle1")
                        .attr("x", 95)
					    .attr("y", 257)
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("0%");

                    svg1.append("text")
                        .attr("class", "textstyle1")
                        .attr("x", 95)
					    .attr("y", 337)
					    .style("alignment-baseline", "baseline")
					    .style("text-anchor", "start")
					    .text("100%");

                    svg1.append("circle")
					    .attr("cx", 82)
					    .attr("cy", 355)
                        .attr("r", 7)
					    .style("fill", "none")
                        .style("stroke", "#4C4848")
                        .style("stroke-width", "2");

                    svg1.append("text")
                        .attr("class", "textstyle1")
					    .attr("x", 95)
					    .attr("y", 356)
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
					    .text("No data");

                    svg1.append("text")
					    .attr("x", 95)
					    .attr("y", 370)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "10px")
                        .style("font-style", "italic")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("Radius still represents");

                    svg1.append("text")
					    .attr("x", 95)
					    .attr("y", 381)
                        .style("font-family", "Rajdhani")
					    .style("font-size", "10px")
                        .style("font-style", "italic")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("total no. of followers");
				});

			</script>


			<!--    				Age vs. Longitude Graph

									Same format as the graph above

			-->

			<svg id="graph2" style="display: block; margin-left: 0 auto; margin-right: 0 auto" viewBox="-50 0 1100 454" preserveAspectRatio="xMidYMid meet">
			</svg>
			<script type="text/javascript">
				var svg2 = d3.select("#graph2");
                svg2.append("text")
						.attr("x", -20)
					    .attr("y", 40)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "16px")
                        .style("font-style", "italic")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
                        .style("fill", "#C1C1C1")
					    .text("BY AGE & MAIN SOCIAL MEDIA PLATFORM");

				var socialMediaData1;

				d3.json("data/Merged_Data_Feb21.json", function (error, data) {
					socialMediaData1 = data;

					var age = d3.extent(socialMediaData1, function (d) {
						return d.age;
					});

					//Statistics
					var ageMedian = median(age);
					var ageMax = Math.max.apply(null,age);
					var ageMin = Math.min.apply(null,age);

					var ageScale = d3.scaleLinear()
					.domain([20,ageMax])
					.range([360, 40]);

					var longitudeExtent1 = d3.extent(socialMediaData1, function (d) {
						return d.capitalLongitude;
					});

					var longitudeScale1 = d3.scaleLinear()
					    .domain(longitudeExtent1)
					    .range([0, 1000]);

					var longitudeAxis1 = d3.axisBottom(longitudeScale1);
					var longitudeTicks1 = svg2.append("g")
					.attr("transform", "translate(0, 410)")
					.call(longitudeAxis1);

                    // set style of longitude axis
                    longitudeTicks1.selectAll("text")
                        .style("font-family", "Rajdhani")
                        .attr("fill", "#4C4848");
                    longitudeTicks1.selectAll("path")
                        .attr("stroke", "#4C4848");
                    longitudeTicks1.selectAll("line")
                        .attr("stroke", "none");

                    var ageAxis = d3.axisLeft(ageScale);
					var ageTicks = svg2.append("g")
					.attr("transform", "translate(40, 50)")
					.call(ageAxis);

                    // set style of age axis
                    ageTicks.selectAll("text")
                        .style("font-family", "Rajdhani")
                        .attr("fill", "#8C8C8B");
                    ageTicks.selectAll("path")
                        .attr("stroke", "#8C8C8B");
                    ageTicks.selectAll("line")
                        .attr("stroke", "none");

					var followersScale1 = d3.scaleSqrt()
					.domain([0, 98247052])
					.range([15, 50]);

					var approvalExtent1 = d3.extent(socialMediaData1, function (d) {
						return d.approvalRatings;
					});

					var approvalScale1 = d3.scaleLinear()
					.domain(approvalExtent1)
					.range([0,1]);

					svg2.append("text")
						.attr("x", 500)
					    .attr("y", 445)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "middle")
                        .style("fill", "#4C4848")
					    .text("Longitude");

					svg2.append("text")
					    .attr("x", -20)
					    .attr("y", 65)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
                        .style("fill", "#8C8C8B")
					    .text("Age");

					//Line for Median
					svg2.append("line")
					    .attr("x1",40)
					    .attr("x2",width)
					    .attr("y1",ageScale(ageMedian))
					    .attr("y2",ageScale(ageMedian))
                        .attr("transform", "translate(0, 50)")
					    .style("stroke", "#4C4848");
					//Text for Median
					svg2.append("text")
					    .attr("x", 980)
					    .attr("y", ageScale(ageMedian)-5)
                        .attr("transform", "translate(0, 50)")
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
                        .style("font-weight", 600)
					    .style("fill", "#C1C1C1")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "end")
					    .text("Median: " + ageMedian);

					//Line for Max Age
					svg2.append("line")
					    .attr("x1",40)
					    .attr("x2",width)
					    .attr("y1",ageScale(ageMax))
					    .attr("y2",ageScale(ageMax))
                        .attr("transform", "translate(0, 50)")
					    .style("stroke", "#4C4848");
					//Text for Max Age
					svg2.append("text")
					    .attr("x", 980)
					    .attr("y", ageScale(ageMax)-5)
                        .attr("transform", "translate(0, 50)")
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
                        .style("font-weight", 600)
					    .style("fill", "#C1C1C1")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "end")
					    .text("Oldest: " + ageMax);
                    svg2.append("text")
					    .attr("x", 980)
					    .attr("y", ageScale(ageMax)-20)
                        .attr("transform", "translate(0, 50)")
					    .style("font-family", "Rajdhani")
					    .style("font-size", "11px")
                        .style("font-style", "italic")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "end")
					    .text("Queen Elizabeth II, sovereign of multiple states");

					//Line for Min Age
					svg2.append("line")
					    .attr("x1",40)
					    .attr("x2",width)
					    .attr("y1",ageScale(ageMin))
					    .attr("y2",ageScale(ageMin))
                        .attr("transform", "translate(0, 50)")
					    .style("stroke", "#4C4848");
					//Text for Min Age
					svg2.append("text")
					    .attr("x", 980)
					    .attr("y", ageScale(ageMin)-5)
                        .attr("transform", "translate(0, 50)")
					    .style("font-family", "Rajdhani")
					    .style("font-size", "14px")
					    .style("fill", "#C1C1C1")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "end")
					    .text("Youngest: " + ageMin);
                    svg2.append("text")
					    .attr("x", 980)
					    .attr("y", ageScale(ageMin)+5)
                        .attr("transform", "translate(0, 50)")
					    .style("font-family", "Rajdhani")
					    .style("font-size", "11px")
                        .style("font-style", "italic")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "end")
					    .text("Sebastian Kurz, Federal Chancellor of Austria");

					socialMediaData1.forEach(function (d) {
					    if (d.age != null) {
	                        if (d.capitalLongitude > -150) {
		                        if (d.totalFollowers != 0) {
							        if (d.totalFollowers >= 10021649) {
							            svg2.append("circle")
							           	.attr("cx", longitudeScale1(d.capitalLongitude))
							            .attr("cy", ageScale(d.age))
							            .attr("r", followersScale1(d.totalFollowers))
		                                .attr("transform", "translate(0, 50)")
							            .style("fill", colorThirdGraph(d))
							            .style("opacity", .6);

							            svg2.append("line")
							            .attr("x1",longitudeScale1(d.capitalLongitude))
							            .attr("x2",longitudeScale1(d.capitalLongitude))
							            .attr("y1",0)
							            .attr("y2",ageScale(d.age)+50)
							            .style("opacity", 0.3)
							            .style("stroke-dasharray","5,5")
							            .style("stroke", "#C1C1C1");
							        }
							        else {
							            svg2.append("circle")
							            .attr("cx", longitudeScale1(d.capitalLongitude))
							            .attr("cy", ageScale(d.age))
							            .attr("r", 3)
		                                .attr("transform", "translate(0, 50)")
							            .style("fill", colorThirdGraph(d))
							            .style("opacity", .6);
							        };
							    }
							    else {
							    	svg2.append("circle")
							            .attr("cx", longitudeScale1(d.capitalLongitude))
							            .attr("cy", ageScale(d.age))
							            .attr("r", 3)
		                                .attr("transform", "translate(0, 50)")
							            .style("fill", colorThirdGraph(d))
							            .style("opacity", .1);
							    };
	                        };
                        };
					});

                    // to layer text above circles.
                    socialMediaData1.forEach(function (d) {
					    if (d.totalFollowers >= 10021649) {

                            svg2.append("circle")
					        .attr("cx", longitudeScale1(d.capitalLongitude))
					        .attr("cy", ageScale(d.age))
                            .attr("transform", "translate(0, 50)")
					        .attr("r", 1)
					        .style("fill", "#C1C1C1");

                            if (d.worldLeader != "Narendra Modi") {
                                svg2.append("text")
                                .attr("x", longitudeScale1(d.capitalLongitude)+5)
                                .attr("y", ageScale(d.age)-0.8)
                                .attr("transform", "translate(0, 50)")
                                .style("font-family", "Rajdhani")
                                .style("font-size", "10px")
                                .style("alignment-baseline", "middle")
                                .style("fill", "#C1C1C1")
                                .text(d.worldLeader);
                            }
					        else {
                                svg2.append("text")
                                .attr("x", longitudeScale1(d.capitalLongitude)+5)
                                .attr("y", ageScale(d.age)-0.8)
                                .attr("transform", "translate(0, 50)")
                                .style("font-family", "Rajdhani")
                                .style("font-size", "10px")
                                .style("alignment-baseline", "hanging")
                                .style("fill", "#C1C1C1")
                                .text(d.worldLeader);
                            };
                        };
                    });
				});

			</script>



			<!--    				Stacked Bars

									Used Abhisek Jana's explanation as a guide for building this graph:
									http://www.adeveloperdiary.com/d3-js/create-stacked-bar-chart-using-d3-js/

                                    Used Mike Bostock's wrap function to wrap bar graph x-axis labels:
                                    https://bl.ocks.org/mbostock/7555321

			-->
            <svg id="graph3" style="display: block; margin-left: 0 auto; margin-right: 0 auto" viewBox="-50 0 1100 570" preserveAspectRatio="xMidYMid meet">
			</svg>
			<script type="text/javascript">
                // wrap function taken from mike bostock
                function wrap(text, width) {
                  text.each(function() {
                    var text = d3.select(this),
                        words = text.text().split(/\s+/).reverse(),
                        word,
                        line = [],
                        lineNumber = 0,
                        lineHeight = 1.1, // ems
                        y = text.attr("y"),
                        dy = parseFloat(text.attr("dy")),
                        tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
                    while (word = words.pop()) {
                      line.push(word);
                      tspan.text(line.join(" "));
                      if (tspan.node().getComputedTextLength() > width) {
                        line.pop();
                        tspan.text(line.join(" "));
                        line = [word];
                        tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
                      }
                    }
                  });
                }

                var svg3 = d3.select(graph3);
                svg3.append("text")
						.attr("x", -20)
					    .attr("y", 40)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "16px")
                        .style("font-style", "italic")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
                        .style("fill", "#C1C1C1")
					    .text("BREAKDOWN OF TOP 10 WORLD LEADERS' FOLLOWERS");

                // Pope's annotation
                    svg3.append("path")
                        .attr("d", "M 415 225 L 440 300 460 300")
                        .attr("stroke", "#8C8C8B")
                        .attr("stroke-width", 1)
                        .attr("fill", "none");

                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 415)
					    .attr("y", 196)
                        .style("alignment-baseline", "baseline")
					    .style("text-anchor", "middle")
					    .text("Includes 9 official");

                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 415)
					    .attr("y", 208)
                        .style("alignment-baseline", "basline")
					    .style("text-anchor", "middle")
					    .text("Twitter accounts in");

                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 415)
					    .attr("y", 220)
                        .style("alignment-baseline", "baseline")
					    .style("text-anchor", "middle")
					    .text("different languages");

                // Modi's annotation
                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 824)
					    .attr("y", 70)
                        .style("fill", "#C1C1C1")
                        .style("alignment-baseline", "baseline")
					    .style("text-anchor", "middle")
					    .text("#1");
                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 824)
					    .attr("y", 82)
                        .style("alignment-baseline", "baseline")
					    .style("text-anchor", "middle")
					    .text("98.2 million");

                // Trump's annotation
                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 214)
					    .attr("y", 123)
                        .style("fill", "#C1C1C1")
                        .style("alignment-baseline", "baseline")
					    .style("text-anchor", "middle")
					    .text("#2");
                    svg3.append("text")
                        .attr("class", "textstyle3")
                        .attr("x", 214)
					    .attr("y", 135)
                        .style("alignment-baseline", "baseline")
					    .style("text-anchor", "middle")
					    .text("79.5 million");

				d3.json("data/Merged_Data_Feb21.json", function (error, data) {
					socialMediaData2 = data;
					var top10Leaders = [null];
					var Leaders = d3.extent(socialMediaData2, function (d) {
						if (d.totalFollowers != 0) {
							if (d.totalFollowers >= 10021649) {
									top10Leaders.push(d.worldLeader);
							}
						}
					});
					var totalFollowers = d3.extent(socialMediaData2, function (d) {
						return d.totalFollowers;
					});

					//Statistics of Followers
					var followersMax = Math.max.apply(null,totalFollowers);
					var followersMin = Math.min.apply(null,totalFollowers);

					var xData = ["Enrique Peña Nieto", "Donald Trump", "Justin Trudeau", "Mauricio Macri", "Pope Francis", "Recep Tayyip Erdoğan", "Dmitry Medvedev", "Sheikh Mohammed bin Rashid Al Maktoum", "Narendra Modi", "Joko Widodo"];

					var dataByCountryStack = [ //LISTOS:
								[
									{"x":0, "y0":0, "y":5540710}, //Mexico
									{"x":1, "y0":0, "y":23126205}, //United States
									{"x":2, "y0":0, "y":5554786}, //Canada
									{"x":3, "y0":0, "y":4507652}, //Argentina
									{"x":4, "y0":0, "y":0}, //Vatican City
									{"x":5, "y0":0, "y":8941440}, //Turkey
									{"x":6, "y0":0, "y":1443723}, //Russia
									{"x":7, "y0":0, "y":3770528}, //United Arab Emirates
									{"x":8, "y0":0, "y":43201619}, //India
									{"x":9, "y0":0, "y":8010255}, //Indonesia
								],
								[
									{"x":0, "y0":5540710, "y":7078859}, //Mexico
									{"x":1, "y0":23126205, "y":47801783}, //United States
									{"x":2, "y0":5554786, "y":3970003}, //Canada
									{"x":3, "y0":4507652, "y":4702549}, //Argentina
									{"x":4, "y0":0, "y":45248276}, //Vatican City
									{"x":5, "y0":8941440, "y":12446840}, //Turkey
									{"x":6, "y0":1443723, "y":5467787}, //Russia
									{"x":7, "y0":3770528, "y":8697675}, //United Arab Emirates
									{"x":8, "y0":43201619, "y":40231657}, //India
									{"x":9, "y0":8010255, "y":9634150}, //Indonesia
								],
								[
									{"x":0, "y0":5540710+7078859, "y":310777}, //Mexico
									{"x":1, "y0":23126205+47801783, "y":8433374}, //United States
									{"x":2, "y0":5554786+3970003, "y":1976544}, //Canada
									{"x":3, "y0":4507652+4702549, "y":780507}, //Argentina
									{"x":4, "y0":0+45248276, "y":5255586}, //Vatican City
									{"x":5, "y0":8941440+12446840, "y":3282239}, //Turkey
									{"x":6, "y0":1443723+5467787, "y":2933426}, //Russia
									{"x":7, "y0":3770528+8697675, "y":0}, //United Arab Emirates
									{"x":8, "y0":43201619+40231657, "y":11581545}, //India
									{"x":9, "y0":8010255+9634150, "y":7957893}, //Indonesia
								]
							];

					var colors = d3.scaleOrdinal().range(["#3b5998", "#1dcaff", "#cd486b"]);

					var yScale = d3.scaleLinear()
						.domain([0,d3.max(dataByCountryStack[dataByCountryStack.length - 1],function (d) { return d.y0 + d.y;})])
						.range([360, 40]);

					var yAxis = d3.axisLeft(yScale).tickFormat(function(d,i){ return Math.floor(d)/1000000 });
					var yTicks = svg3.append("g")
						.attr("transform", "translate(40, 50)")
						.call(yAxis);

                    // set style of y axis
				    yTicks.selectAll("text")
                        .style("font-family", "Rajdhani")
						.style("font-size", "10px")
                        .style("fill", "#8C8C8B");

                    yTicks.selectAll("path")
                        .attr("stroke", "#8C8C8B");
                    yTicks.selectAll("line")
                        .attr("stroke", "#8C8C8B");

					var xScale = d3.scaleLinear()
						.domain([-1,10])
						.range([40, 1000]);

					var xAxis = d3.axisBottom(xScale).tickValues([0,1,2,3,4,5,6,7,8,9,10])
						.tickFormat(function(d,i){ return xData[i] });
					var xTicks = svg3.append("g")
						.attr("transform", "translate(0, 410)")
						.call(xAxis);

                    // set style of x axis
				    xTicks.selectAll("text")
                        .attr("transform", "translate(0, 70)")
                        .style("font-family", "Rajdhani")
						.style("font-size", "10px")
                        .style("fill", "#C1C1C1")
				        .style("text-anchor", "middle")
                        .style("text-align", "center")
                        .call(wrap, 100);

                    xTicks.selectAll("path")
                        .attr("stroke", "#8C8C8B");
                    xTicks.selectAll("line")
                        .attr("stroke", "#none");

                    // Country labels
                    var xCountry = ["MEXICO", "USA", "CANADA", "ARGENTINA", "VATICAN CITY", "TURKEY", "RUSSIA", "UAE", "INDIA", "INDONESIA"];

                    var xAxisCountry = d3.axisBottom(xScale).tickValues([0,1,2,3,4,5,6,7,8,9,10])
						.tickFormat(function(d,i){ return xCountry[i] });
                    var xAxisTicks = svg3.append("g")
                        .attr("transform", "translate(0, 465)")
						.call(xAxisCountry);

                    xAxisTicks.selectAll("text")
                        .style("font-family", "Rajdhani")
				        .style("font-size", "11px")
                        .style("fill", "#8C8C8B")
				        .style("text-anchor", "middle")
                        .style("text-align", "center")
                        .call(wrap, 100);

                    xAxisTicks.selectAll("path")
                        .attr("stroke", "#none");
                    xAxisTicks.selectAll("line")
                        .attr("stroke", "#none");

					svg3.append("text")
						.attr("x", -20)
						.attr("y", 70)
						.style("font-family", "Rajdhani")
						.style("font-size", "14px")
						.style("alignment-baseline", "middle")
						.style("text-anchor", "start")
                        .style("fill", "#8C8C8B")
						.text("Followers (in millions)");

					svg3.append("text")
						.attr("x", 500)
						.attr("y", 538)
						.style("font-family", "Rajdhani")
						.style("font-size", "14px")
						.style("alignment-baseline", "middle")
						.style("text-anchor", "middle")
                        .style("fill", "#8C8C8B")
						.text("Leaders");

					var layer = svg3.selectAll(".stack")
					    .data(dataByCountryStack)
					    .enter().append("g")
					    .attr("class", "stack")
					    .attr("fill", function(d, i) { return colors(i); })
                        .style("opacity", 0.8);

					layer.selectAll("rect")
					    .data(function (d) {
					        return d;
					    })
					    .enter().append("rect")
					    .attr("x", function (d) {
					        return xScale(d.x) - 25;
					    })
					    .attr("y", function (d) {
					        return yScale(d.y + d.y0) + 50;
					    })
					    .attr("height", function (d) {
					        return yScale(d.y0) - yScale(d.y + d.y0);
					    })
					    .attr("width", 50);

                    // Susie Lu's Legend (http://d3-legend.susielu.com/)
                    // Graph 3 legend
					var colorLegend3 = d3.legendColor()
				        .labelFormat(d3.format(".0f"))
				        .scale(colors)
                        .shape("circle")
                        .shapeRadius(3)
				        .shapePadding(10)
				        .labelOffset(8)
				        .labels(["Facebook", "Twitter", "Instagram"]);

				    svg2.append("g")
				        .attr("transform", "translate(74, 125)")
				        .attr("font-family", "Rajdhani")
				        .attr("font-size", 11)
                        .attr("fill", "#8C8C8B")
				        .attr("id", "legend_3")
				        .call(colorLegend3);

                    svg2.append("text")
					    .attr("x", 69)
					    .attr("y", 110)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "11px")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
					    .text("MAIN PLATFORM");

                    svg2.append("circle")
					    .attr("cx", 74)
					    .attr("cy", 176)
                        .attr("r", 3)
					    .style("fill", "#C0C0C0")
					    .style("opacity", 0.3);

                    svg2.append("text")
					    .attr("x", 85)
					    .attr("y", 176)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "11px")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "middle")
					    .style("text-anchor", "start")
					    .text("No social media");

                    svg2.append("text")
					    .attr("x", 85)
					    .attr("y", 188)
					    .style("font-family", "Rajdhani")
					    .style("font-size", "10px")
                        .style("font-style", "italic")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("Radius still represents");

                    svg2.append("text")
					    .attr("x", 85)
					    .attr("y", 199)
                        .style("font-family", "Rajdhani")
					    .style("font-size", "10px")
                        .style("font-style", "italic")
					    .style("fill", "#8C8C8B")
					    .style("alignment-baseline", "hanging")
					    .style("text-anchor", "start")
					    .text("total no. of followers");

                    // Graph 4 legend
                    var colorLegend4 = d3.legendColor()
				        .labelFormat(d3.format(".0f"))
				        .scale(colors)
				        .shapePadding(7)
				        .shapeWidth(10)
				        .shapeHeight(10)
				        .labelOffset(10)
                        .ascending(true)
				        .labels(["Facebook", "Twitter", "Instagram"]);

				    svg3.append("g")
				        .attr("transform", "translate(70, 110)")
				        .attr("font-family", "Rajdhani")
				        .attr("font-size", 11)
                        .attr("fill", "#8C8C8B")
				        .attr("id", "legend_4")
				        .call(colorLegend4);

                    // profile pictures
                    // grayscale filter adapted from https://stackoverflow.com/questions/27357917/graying-out-an-image-in-d3js
                    svg3.append("filter")
                          .attr("id","grayscale")
                          .append("feColorMatrix")
                          .attr("type", "matrix")
                          .attr("opacity", 0.7)
                          .attr("values","0.3, 0.59, 0.11, 0, 0, 0.3, 0.59, 0.11, 0, 0, 0.3, 0.59, 0.11, 0, 0, 0, 0, 0, 1, 0");

                    svg3.append("image")
                        .attr("id", "NietoPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/991180595710513152/V5O-Z320_400x400.jpg")
                        .attr("x", "102")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "TrumpPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/874276197357596672/kUuht00m_400x400.jpg")
                        .attr("x", "189")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "TrudeauPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/1188901535851388929/_9nGMr9S_400x400.jpg")
                        .attr("x", "276")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "MacriPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/653558348273569792/joxg8DZD_400x400.png")
                        .attr("x", "364")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "PopePP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/507818066814590976/KNG-IkT9_400x400.jpeg")
                        .attr("x", "451")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "ErdoganPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/887001037269323777/g6yxuJvl_400x400.jpg")
                        .attr("x", "539")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "MedvedevPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/2348669225/5sfntu2zxyvans8vf9n8_400x400.png")
                        .attr("x", "626")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "SheikhPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/561879065271865344/Km0x5XFD_400x400.jpeg")
                        .attr("x", "714")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "ModiPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/718314968102367232/ypY1GPCQ_400x400.jpg")
                        .attr("x", "801")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });

                    svg3.append("image")
                        .attr("id", "WidodoPP")
                        .attr("xlink:href", "https://pbs.twimg.com/profile_images/1185747474012442625/SWdGwudP_400x400.jpg")
                        .attr("x", "888")
                        .attr("y", "416")
                        .attr("width", "50")
                        .attr("height", "50")
                        .attr("opacity", 0.8)
                        .style("filter", function(d, i) {
                          if (i % 2 == 0) {
                            return ("filter", "url(#grayscale)");
                          } else {
                            return "";
                          }
                        });
				});
			</script>
		</p>
        <p id="footnotes">
            SOURCES:
            <br>Social media data was compiled by <a href="http://cuponation.com/world-leaders-social-media/">CupoNation (2018)</a>.
            <br>Population data was retreived from <a href="https://data.worldbank.org/indicator/SP.POP.TOTL">World Bank World Development Indicators (2016)</a> and <a href="https://esa.un.org/unpd/wpp/DataQuery/">UN Population Division, World Population Prospects (2016)</a>.
            <br>Approval ratings data was taken from the <a href="https://analyticscampus.gallup.com">Gallup World Poll (2017)</a>.
            <br>Capital city coordinates were taken from a dataset by <a href="http://techslides.com/list-of-countries-and-capitals">Techslides (2013)</a>.
            <br>Profile pictures are taken from each leader's <a href="https://twitter.com/">Twitter</a> account page.
            <br>Fonts used are <a href="https://fonts.google.com/specimen/Rubik+Mono+One">Rubik Mono One</a> by Hubert and Fischer and <a href="https://fonts.google.com/specimen/Rajdhani">Rajdhani</a> by Indian Type Foundry, from Google Fonts.
        </p>
	</body>
</html>
